Get-AzureADServicePrincipal -All $true | Where-Object {($_.Tags -contains "WindowsAzureActiveDirectoryGalleryApplicationNonPrimaryV1") -or ($_.Tags -contains "WindowsAzureActiveDirectoryCustomSingleSignOnApplication") -or ($_.Tags -contains "WindowsAzureActiveDirectoryGalleryApplicationPrimaryV1")}| sort displayname| Select DisplayName, @{Name="AppType"; Expression={$type}}, ObjectID